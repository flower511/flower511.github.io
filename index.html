<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æœˆäº®å«é†’ä½ äº†</title>

<style>
*{margin:0;padding:0;box-sizing:border-box}

body{
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
  background:
    radial-gradient(circle at 15% 20%, #eaf6ef, transparent 40%),
    radial-gradient(circle at 85% 0%, #eef2ff, transparent 40%),
    linear-gradient(135deg,#f7f9fc,#eef2f6);
  min-height:100vh;
  padding:20px;
}

.card{
  max-width:820px;
  margin:auto;
  background:#fff;
  border-radius:18px;
  padding:34px 22px;
  box-shadow:0 14px 45px rgba(0,0,0,.08);
  text-align:center;
}

h1{
  font-size:2.2em;
  background:linear-gradient(90deg,#3cb371,#2ecc71);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}

.sub{
  margin-top:6px;
  color:#777;
  font-size:.95em;
}

.notice{
  margin-top:14px;
  padding:12px;
  border-radius:10px;
  background:#f6f8fb;
  font-size:.95em;
  color:#555;
}

.section{margin:26px 0}

.section h2{
  font-size:1.2em;
  margin-bottom:8px;
}

p{
  color:#555;
  font-size:1.05em;
  margin:6px 0;
}

.btn{
  display:inline-block;
  padding:12px 30px;
  background:#3cb371;
  color:#fff;
  border-radius:30px;
  font-weight:bold;
  text-decoration:none;
  margin-top:10px;
}

.wechat{
  font-size:1.15em;
  margin-top:8px;
}

#wechatId{
  color:#007bff;
  cursor:pointer;
  font-weight:bold;
}

#copyTip,#resultMsg{
  margin-top:8px;
  font-size:.95em;
  font-weight:bold;
}

.hint{
  margin-top:10px;
  padding:10px;
  background:#f0f6f2;
  border-radius:8px;
  font-size:.9em;
  color:#4a7c5f;
}

input{
  width:80%;
  max-width:360px;
  padding:12px;
  border-radius:8px;
  border:1px solid #ccc;
  font-size:1em;
}

button{
  margin-top:12px;
  padding:12px 34px;
  border:none;
  border-radius:30px;
  background:#3cb371;
  color:#fff;
  font-size:1em;
  cursor:pointer;
}

button:disabled{
  background:#9fd5b8;
  cursor:not-allowed;
}

.stats{
  margin-top:30px;
  padding-top:20px;
  border-top:1px dashed #ddd;
  font-size:.9em;
  color:#888;
}
</style>
</head>

<body>

<div class="card">
  <h1>æœˆäº®å«é†’ä½ äº†</h1>
  <div class="sub">ç®€å• Â· ç¨³å®š Â· é•¿æœŸå¯ç”¨</div>

  <div class="notice" id="envTip"></div>

  <!-- æµè§ˆå™¨ä¸‹è½½åŒº -->
  <div class="section" id="downloadSection">
    <h2>ğŸ“¥ è·å–æ–¹å¼</h2>
    <p>æ”¯æŒå¸¸è§è®¾å¤‡</p>
    <a class="btn" target="_blank"
      href="https://vp22p-my.sharepoint.com/:f:/g/personal/luokeke_vp22p_onmicrosoft_com/EkiJ3TVxtHpAsV7-LzJEHc0Bu_FNkTNqLrUZuR0TnH_p4Q">
      æ‰“å¼€è·å–é¡µé¢
    </a>
  </div>

  <div class="section">
    <h2>ğŸ“± ç›´æ¥è”ç³»</h2>
    <div class="wechat">
      å¾®ä¿¡ï¼š<span id="wechatId">272017090</span>
    </div>
    <div id="copyTip"></div>
    <div class="hint">ğŸ’¡ å¤åˆ¶åæ‰“å¼€å¾®ä¿¡æœç´¢å³å¯æ·»åŠ ï¼Œå¤‡æ³¨ã€Œè·å–æ–¹å¼ã€</div>
  </div>

  <div class="section">
    <h2>ğŸ“© ä¸æ–¹ä¾¿åŠ ï¼Ÿæˆ‘æ¥è”ç³»ä½ </h2>
    <form id="form">
      <input id="wx" maxlength="30" placeholder="å¡«å†™ä½ çš„å¾®ä¿¡å·">
      <br>
      <button id="btn">æäº¤</button>
      <div id="resultMsg"></div>
      <div class="hint">â° ä¸€èˆ¬åœ¨æ™šä¸Šç»Ÿä¸€å›å¤ï¼Œä¸ä¼šæ‰“æ‰°</div>
    </form>
  </div>

  <div class="stats" id="stats"></div>
</div>

<script>
/* ç¯å¢ƒåˆ¤æ–­ */
const ua = navigator.userAgent.toLowerCase();
const isWeChat = ua.includes("micromessenger");

envTip.textContent = isWeChat
  ? "å½“å‰åœ¨å¾®ä¿¡å†…ï¼Œå»ºè®®ç›´æ¥è”ç³»è·å–æ–¹å¼"
  : "å½“å‰åœ¨æµè§ˆå™¨ä¸­ï¼Œå¯æŸ¥çœ‹å®Œæ•´ä¿¡æ¯";

if(isWeChat){
  downloadSection.style.display="none";
}

/* ç»Ÿè®¡ */
let views = localStorage.views = (Number(localStorage.views)||0)+1;
let submits = Number(localStorage.submits||0);
function renderStats(){
  let rate=submits?((submits/views)*100).toFixed(1):0;
  stats.textContent=`è®¿é—® ${views} ï½œ ç•™èµ„ ${submits} ï½œ è½¬åŒ– ${rate}%`;
}
renderStats();

/* å¤åˆ¶å¾®ä¿¡ */
wechatId.onclick=()=>{
  navigator.clipboard.writeText(wechatId.innerText).then(()=>{
    copyTip.textContent="âœ… å·²å¤åˆ¶ â†’ æ‰“å¼€å¾®ä¿¡æœç´¢æ·»åŠ ";
    copyTip.style.color="#3cb371";
  });
};

/* æäº¤ */
form.onsubmit=e=>{
  e.preventDefault();
  if(!wx.value.trim())return;

  btn.disabled=true;
  btn.textContent="æäº¤ä¸­...";

  fetch(`https://api.day.app/qYjTNs3sCmaABE2BYRrhmU/æ–°ç”¨æˆ·/${encodeURIComponent(wx.value)}`);

  submits++;
  localStorage.submits=submits;
  renderStats();

  resultMsg.textContent="âœ… å·²æ”¶åˆ°ï¼Œæˆ‘ä¼šè”ç³»ä½ ";
  resultMsg.style.color="#3cb371";

  btn.disabled=false;
  btn.textContent="æäº¤";
  wx.value="";
};
</script>

</body>
</html>
